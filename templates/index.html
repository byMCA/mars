{% extends "layout.html" %}

{% block content %}
<style>
    /* Scanning Line Effect */
    @keyframes scanline {
        0% { transform: translateY(-100%); }
        100% { transform: translateY(100%); }
    }
    .scanline-effect::after {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(to bottom, transparent 50%, rgba(0, 240, 255, 0.05) 51%, transparent 52%);
        background-size: 100% 4px;
        animation: scanline 10s linear infinite;
        pointer-events: none;
        z-index: 10;
    }
    .text-glow { text-shadow: 0 0 10px rgba(255, 255, 255, 0.5), 0 0 20px rgba(0, 240, 255, 0.3); }
    .mars-glow { text-shadow: 0 0 10px rgba(224, 60, 49, 0.6); }
    
    /* Golden Effect for Citizen of the Week */
    .gold-glow { 
        text-shadow: 0 0 10px rgba(234, 179, 8, 0.6); 
        box-shadow: 0 0 20px rgba(234, 179, 8, 0.1); 
        border-color: rgba(234, 179, 8, 0.5);
    }
    .gold-border { border: 1px solid rgba(234, 179, 8, 0.5); }
    
    .glitch-hover:hover {
        animation: glitch-skew 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both infinite;
        color: #E03C31;
    }
    @keyframes glitch-skew {
        0% { transform: skew(0deg); }
        20% { transform: skew(-2deg); }
        40% { transform: skew(2deg); }
        60% { transform: skew(-1deg); }
        80% { transform: skew(1deg); }
        100% { transform: skew(0deg); }
    }
</style>

<div class="min-h-screen bg-[#050505] text-white relative overflow-hidden font-sans scanline-effect">
    
    <div class="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-mars-red/10 rounded-full blur-[120px] animate-pulse"></div>
    <div class="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-mars-cyan/5 rounded-full blur-[120px]"></div>

    <div class="max-w-[1600px] mx-auto px-6 py-8 relative z-20">

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 mb-8">
            
            <div class="lg:col-span-8 relative group overflow-hidden rounded-sm border border-white/10 bg-black/40 backdrop-blur-sm h-[500px]">
                <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1614728853913-1e22ba60407d?q=80&w=2069&auto=format&fit=crop')] bg-cover bg-center opacity-60 group-hover:scale-105 transition-transform duration-[2s]"></div>
                <div class="absolute inset-0 bg-gradient-to-r from-black via-black/50 to-transparent"></div>
                
                <div class="absolute bottom-0 left-0 p-10 w-full max-w-3xl">
                    <div class="flex items-center gap-3 mb-4">
                        <span class="px-2 py-1 bg-mars-red text-black text-[10px] font-bold uppercase tracking-widest animate-pulse">Live Broadcast</span>
                        <span class="text-mars-cyan font-mono text-xs">LEFT DATE: {{ durum.sol_date }}</span>
                    </div>
                    
                    <h1 class="text-6xl md:text-7xl font-bold leading-none mb-6 tracking-tighter">
                        MARS <br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-mars-red to-white mars-glow">IS CALLING.</span>
                    </h1>
                    
                    <p class="text-gray-300 text-sm md:text-base max-w-lg mb-8 border-l-2 border-mars-cyan pl-4 leading-relaxed">
                        Earth is aging. A new civilization is rising on the red soil. 
                        Leave an ordinary life behind. The Mars Colony is looking for brave pioneers.
                    </p>

                    <div class="flex flex-wrap gap-4">
                        {% if current_user.is_authenticated %}
                            <a href="{{ url_for('dashboard') }}" class="relative px-8 py-3 bg-white text-black font-bold uppercase tracking-widest hover:bg-mars-cyan transition-colors clip-path-polygon">
                                GO TO MY PANEL
                            </a>
                        {% else %}
                            <a href="{{ url_for('apply') }}" class="relative px-8 py-3 bg-mars-red text-black font-bold uppercase tracking-widest hover:bg-white transition-colors group/btn overflow-hidden">
                                <span class="relative z-10 flex items-center gap-2">
                                    APPLY NOW 
                                    <svg class="w-4 h-4 group-hover/btn:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
                                </span>
                                <div class="absolute inset-0 bg-white transform -translate-x-full group-hover/btn:translate-x-0 transition-transform duration-300 z-0"></div>
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="lg:col-span-4 flex flex-col gap-6">
                
                <div class="flex-grow bg-black/40 border border-white/10 backdrop-blur-md p-6 relative overflow-hidden flex flex-col justify-center items-center text-center group hover:border-mars-red/50 transition-colors">
                    <div class="absolute top-0 right-0 p-4 opacity-20 group-hover:opacity-100 transition-opacity">
                        <svg class="w-16 h-16 text-mars-red animate-spin-slow" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    </div>

                    <h3 class="text-mars-cyan font-mono text-xs tracking-[0.3em] mb-2 uppercase">Active Colony Population</h3>
                    
                    <div class="text-7xl font-bold text-white font-mono tracking-tighter mb-2 text-glow relative z-10">
                        {{ durum.population }}
                    </div>
                    
                    <div class="inline-flex items-center gap-2 px-3 py-1 bg-green-900/30 border border-green-500/30 rounded-full mb-6">
                        <span class="w-2 h-2 bg-green-500 rounded-full animate-ping"></span>
                        <span class="text-[10px] text-green-400 font-bold tracking-widest uppercase">Registered Citizen</span>
                    </div>

                    <div class="w-full max-w-[200px]">
                        <div class="flex justify-between text-[8px] text-gray-500 mb-1 font-mono">
                            <span>CAPACITY FULFILLMENT</span>
                            <span>%{{ (durum.population / 1000 * 100)|round(1) }}</span>
                        </div>
                        <div class="w-full h-1 bg-gray-800 rounded-full overflow-hidden">
                            <div class="h-full bg-mars-red" style="width: {{ (durum.population / 1000 * 100) }}%"></div>
                        </div>
                    </div>
                </div>

                <div class="h-1/3 bg-black/80 gold-border relative overflow-hidden flex items-center p-4 gap-4 gold-glow group">
                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-500/10 to-transparent pointer-events-none group-hover:from-yellow-500/20 transition-colors"></div>
                    
                    <div class="absolute top-0 right-0 px-2 py-1 bg-yellow-500 text-black text-[9px] font-bold uppercase tracking-widest">
                        CITIZEN OF THE WEEK
                    </div>

                    {% if weekly_citizen %}
                        <div class="w-20 h-20 rounded-full border-2 border-yellow-500 p-1 flex-shrink-0 relative shadow-[0_0_15px_rgba(234,179,8,0.5)]">
                            <img src="{{ url_for('static', filename='profile_pics/' + weekly_citizen.image_file) }}" class="w-full h-full object-cover rounded-full grayscale group-hover:grayscale-0 transition-all duration-500">
                            <div class="absolute -bottom-1 -right-1 bg-yellow-500 text-black text-[10px] font-bold w-6 h-6 flex items-center justify-center rounded-full border-2 border-black">#1</div>
                        </div>

                        <div class="z-10 flex flex-col justify-center">
                            <h3 class="text-white font-bold text-lg leading-none mb-1 group-hover:text-yellow-400 transition-colors">
                                {{ weekly_citizen.username }}
                            </h3>
                            <p class="text-yellow-600 text-[10px] font-mono uppercase tracking-wider mb-2">
                                TIER {{ weekly_citizen.tier }} // {{ weekly_citizen.origin }}
                            </p>
                            
                            <div class="flex items-center gap-2 bg-yellow-900/20 px-2 py-1 rounded border border-yellow-500/20 w-fit">
                                <span class="text-[9px] text-gray-400 uppercase">CONTRIBUTION:</span>
                                <span class="text-sm font-bold text-yellow-500 font-mono">{{ weekly_citizen.contribution_score }} XP</span>
                            </div>
                        </div>
                    {% else %}
                        <div class="w-full text-center py-4">
                            <div class="text-yellow-500/50 text-4xl mb-2">?</div>
                            <p class="text-[10px] text-gray-500 italic">Data is being calculated...</p>
                        </div>
                    {% endif %}
                </div>

            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <div class="bg-black/20 border border-white/5 p-5 rounded-sm backdrop-blur-sm flex flex-col justify-between h-[300px] overflow-hidden relative">
                
                <div class="flex justify-between items-center border-b border-white/5 pb-3 mb-2">
                    <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2">
                        <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
                        RANK SYSTEM
                    </h3>
                    <span class="text-[9px] text-gray-600 font-mono">LOCKED</span>
                </div>

                <div class="space-y-3 relative z-10">
                    <div class="group flex items-center gap-3">
                        <div class="w-1.5 h-1.5 bg-gray-500 rounded-full"></div>
                        <div>
                            <h4 class="text-xs font-bold text-gray-300">CITIZEN <span class="text-[9px] text-gray-500 font-normal ml-1">Tier 1</span></h4>
                            <p class="text-[9px] text-gray-600 font-mono">Basic Rights</p>
                        </div>
                    </div>
                    <div class="group flex items-center gap-3">
                        <div class="w-1.5 h-1.5 bg-white rounded-full"></div>
                        <div>
                            <h4 class="text-xs font-bold text-white">ELITE <span class="text-[9px] text-gray-400 font-normal ml-1">Tier 2</span></h4>
                            <p class="text-[9px] text-gray-500 font-mono">Priority Access</p>
                        </div>
                    </div>
                    <div class="group flex items-center gap-3">
                        <div class="w-1.5 h-1.5 bg-mars-cyan rounded-full shadow-[0_0_8px_#00F0FF] animate-pulse"></div>
                        <div>
                            <h4 class="text-xs font-bold text-mars-cyan">NOBLE <span class="text-[9px] text-mars-cyan/60 font-normal ml-1">Tier 3</span></h4>
                            <p class="text-[9px] text-gray-400 font-mono">Passport & Trade</p>
                        </div>
                    </div>
                    <div class="group flex items-center gap-3 opacity-60 hover:opacity-100 transition-all duration-500 hover:blur-0">
                        <div class="w-1.5 h-1.5 bg-yellow-500 rounded-full"></div>
                        <div class="filter blur-[0.5px]">
                            <h4 class="text-xs font-bold text-yellow-500">TECHNOCRAT <span class="text-[9px] text-yellow-600 font-normal ml-1">Tier 4</span></h4>
                            <p class="text-[9px] text-gray-500 font-mono">System Architect</p>
                        </div>
                    </div>
                    <div class="group flex items-center gap-3 opacity-40 select-none">
                        <div class="w-1.5 h-1.5 bg-purple-500 rounded-full"></div>
                        <div class="filter blur-[2px] group-hover:blur-[1px] transition-all">
                            <h4 class="text-xs font-bold text-purple-400">COUNCIL <span class="text-[9px] text-purple-900 font-normal ml-1">Tier 5</span></h4>
                            <p class="text-[9px] text-gray-600 font-mono">Law & Administration</p>
                        </div>
                        <span class="text-[8px] border border-gray-700 text-gray-700 px-1 ml-auto">LOCKED</span>
                    </div>
                    <div class="group flex items-center gap-3 opacity-20 select-none">
                        <div class="w-1.5 h-1.5 bg-red-600 rounded-full"></div>
                        <div class="filter blur-[4px]">
                            <h4 class="text-xs font-bold text-red-600">OVERSEER <span class="text-[9px] font-normal ml-1">Tier 9</span></h4>
                            <p class="text-[9px] text-red-900 font-mono">CLASSIFIED PROTOCOL</p>
                        </div>
                    </div>
                </div>
                
                <div class="absolute bottom-0 left-0 w-full h-12 bg-gradient-to-t from-black via-black/80 to-transparent z-20 pointer-events-none"></div>
            </div>

            <div class="bg-black border border-mars-red/20 p-0 rounded-sm overflow-hidden flex flex-col h-[300px]">
                <div class="bg-mars-red/10 p-3 border-b border-mars-red/20 flex justify-between items-center">
                    <span class="text-[10px] text-mars-red font-mono font-bold tracking-widest">>> SYSTEM_LOG // PLANET_ORDERS</span>
                    <div class="flex gap-1">
                        <div class="w-2 h-2 bg-mars-red rounded-full animate-pulse"></div>
                    </div>
                </div>
                
                <div class="p-4 overflow-y-auto custom-scrollbar flex-grow font-mono text-xs space-y-4">
                    {% for decree in decrees %}
                    <div class="border-l-2 {% if decree.is_classified %}border-red-900{% else %}border-gray-700{% endif %} pl-3 py-1 hover:bg-white/5 transition-colors">
                        <div class="flex justify-between text-[9px] text-gray-500 mb-1">
                            <span>[{{ decree.date_posted.strftime('%H:%M') }}] ID:{{ decree.id }}</span>
                            {% if decree.is_classified %}<span class="text-red-700 blink">CLASSIFIED</span>{% endif %}
                        </div>
                        
                        {% if decree.is_classified and (not current_user.is_authenticated or current_user.tier < 19) %}
                            <span class="text-gray-600 blur-[2px] select-none">████████████████████</span>
                            <span class="text-[9px] text-red-900 ml-2 block">> ACCESS DENIED</span>
                        {% else %}
                            <a href="{{ url_for('duyuru_detay', id=decree.id) }}" class="text-gray-300 hover:text-mars-cyan hover:underline decoration-mars-cyan/50 underline-offset-4 block">
                                {{ decree.title }}
                            </a>
                        {% endif %}
                    </div>
                    {% else %}
                    <div class="text-gray-600 text-center mt-10">>> NO DATA FLOW. SYSTEM ON STANDBY.</div>
                    {% endfor %}
                </div>
            </div>

            <div class="bg-black/20 border border-white/5 p-5 rounded-sm backdrop-blur-sm flex flex-col h-[300px] relative overflow-hidden group">
                
                <div class="flex justify-between items-center border-b border-white/5 pb-3 mb-3">
                    <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2">
                        <span class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></span>
                        OPEN FORUM
                    </h3>
                    <a href="{{ url_for('index') }}" class="text-[9px] text-blue-500 hover:text-white transition-colors font-mono">VIEW ALL &rarr;</a>
                </div>

                <div class="flex-grow space-y-3 relative z-10">
                    
                    <a href="{{ url_for('forum') }}" class="block bg-white/5 p-3 border-l-2 border-blue-900 hover:border-blue-500 hover:bg-white/10 transition-all group/item">
                        <div class="flex justify-between items-start mb-1">
                            <h4 class="text-xs font-bold text-gray-300 group-hover/item:text-blue-300 line-clamp-1">Water Purification Unit Maintenance Procedure</h4>
                            <span class="text-[8px] bg-blue-900/30 text-blue-400 px-1 py-0.5 rounded border border-blue-500/20">TECHNICAL</span>
                        </div>
                        <div class="flex justify-between text-[9px] text-gray-600 font-mono">
                            <span>Author: Engineer_01</span>
                            <span>2 mins ago</span>
                        </div>
                    </a>

                    <a href="{{ url_for('forum') }}" class="block bg-white/5 p-3 border-l-2 border-green-900 hover:border-green-500 hover:bg-white/10 transition-all group/item">
                        <div class="flex justify-between items-start mb-1">
                            <h4 class="text-xs font-bold text-gray-300 group-hover/item:text-green-300 line-clamp-1">Dome-to-Dome Trade Taxes</h4>
                            <span class="text-[8px] bg-green-900/30 text-green-400 px-1 py-0.5 rounded border border-green-500/20">ECONOMY</span>
                        </div>
                        <div class="flex justify-between text-[9px] text-gray-600 font-mono">
                            <span>Author: Merchant_X</span>
                            <span>14 mins ago</span>
                        </div>
                    </a>

                    <a href="{{ url_for('forum') }}" class="block bg-white/5 p-3 border-l-2 border-purple-900 hover:border-purple-500 hover:bg-white/10 transition-all group/item">
                        <div class="flex justify-between items-start mb-1">
                            <h4 class="text-xs font-bold text-gray-300 group-hover/item:text-purple-300 line-clamp-1">Red Storm: Security Warning</h4>
                            <span class="text-[8px] bg-purple-900/30 text-purple-400 px-1 py-0.5 rounded border border-purple-500/20">GENERAL</span>
                        </div>
                        <div class="flex justify-between text-[9px] text-gray-600 font-mono">
                            <span>Author: System_Root</span>
                            <span>1 hour ago</span>
                        </div>
                    </a>

                </div>
                
                <div class="mt-auto pt-2">
                    <a href="{{ url_for('index') }}" class="block w-full py-2 bg-blue-900/20 border border-blue-500/30 text-blue-400 text-[10px] font-bold text-center hover:bg-blue-500 hover:text-black transition-colors uppercase tracking-widest">
                        + START NEW TOPIC
                    </a>
                </div>

                <div class="absolute bottom-0 right-0 w-32 h-32 bg-blue-500/5 rounded-full blur-2xl pointer-events-none"></div>
            </div>

        </div>

    </div>
</div>
{% endblock %}